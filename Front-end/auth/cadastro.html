<!DOCTYPE html>
<html lang="pt-br">

<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <title>WiseTour</title>

  <link rel="stylesheet" href="css/style.css">

  <script src="https://kit.fontawesome.com/041dbc8823.js" crossorigin="anonymous"></script>
  <script src="/common/js/nav-bar.js"></script>

  <script defer src="/auth/js/geotrack.js"></script>

</head>


<body id="cadastro_body">



  <img id="forma_esquerda" class="forma" src="assets/img/forma_bg.svg" alt="">
  <img id="forma_direita" class="forma" src="assets/img/forma_bg.svg" alt="">

  <header id="header" class="header">

    <div class="container_mobile mobile">
      <nav id="nav_bar_mobile" class="navbar">
        <div class="container">
          <a class="opcao" href="/auth/cadastro.html">CADASTRE-SE</a>
          <a class="opcao" href="/auth/login.html">ENTRAR</a>
        </div>
      </nav>
      <a class="seta" href="../index.html"><i class="fa-solid fa-arrow-left"></i></a>
      <img src="/common/assets/logo/logo_cinza_escuro.svg" id="logo">
      <i id="botao_nav_bar" onclick="habilitarNavBarMobile()" class="fa-solid fa-bars"></i>
    </div>

  </header>




  <a class="seta desktop" href="../index.html"><i class="fa-solid fa-arrow-left"></i></a>


  <img class="logo desktop" src="/common/assets/logo/logo_cinza_escuro.svg" alt="">

  <!-- MAIN -->

  <main>
    
    <div id="cardErro" style="display: none; color: red;">
      <span id="mensagem_erro"></span>
    </div>    
    <!-- FORM -->
    <div class="container_form">
      <h2>CADASTRAR</h2>
      <form class="form">
        <p>Quer fazer parte do <b>WiseTour?</b></p>
        <div class="container">
          <i class="fa-solid fa-user"></i>
          <input id="nome_completo_input" type="text" placeholder="| Digite seu nome">
        </div>
        <div class="container">
          <i class="fa-solid fa-envelope"></i>
          <input id="email_input" type="text" placeholder="| Digite seu e-mail">
        </div>
        <div class="container">
          <i class="fa-solid fa-phone"></i>
          <input id="numero_usuario_input" type="text" placeholder="| Digite seu telefone">
        </div>
        <p>Nossa equipe entrará em contato com você para entender suas necessidades e guiar os próximos passos.
        </p>
        <button class="btn" onclick="cadastrar()" type="button">ENVIAR</button>
      </form>
    </div>
    <!-- /FORM -->


    <!-- PASSAPORTE E PASSAGEM  -->

    <div class="container passaporte_passagem">
      <div class="passagem passagem_superior">
        <a href="/auth/login.html">
          <h2>ENTRAR</h2>
        </a>

        <span>DE: <b id="estado">BRAZIL</b></span>
        <span>PARA: <b>WISETOUR</b></span>

        <div class="linha_tracejada">
          <div></div>
          <div></div>
          <div></div>
          <div></div>
          <div></div>
          <div></div>
        </div>

      </div>
      <div class="container">
        <div class="passagem passagem_inferior"></div>
        <div class="passaporte">
          <h4>PASSAPORTE DE ENTRADA</h4>
          <img src="/common/assets/logo/logo_cinza_escuro.svg" alt="">
          <p>transformando dados em destinos de sucesso</p>
        </div>
      </div>
    </div>

    <!-- /PASSAPORTE E PASSAGEM  -->


  </main>

  <!-- /MAIN -->



</body>

</html>
<script>
  function cadastrar() {
    // aguardar();

    //Recupere o valor da nova input pelo nome do id
    // Agora vá para o método fetch logo abaixo
    var nomeCompletoVar = nome_completo_input.value;
    var emailVar = email_input.value;
    var numeroUsuarioVar = numero_usuario_input.value;

    // Verificando se há algum campo em branco
    if (
      nomeCompletoVar == "" ||
      emailVar == "" ||
      numeroUsuarioVar == ""
    ) {
      cardErro.style.display = "block";
      mensagem_erro.innerHTML =
        "(Mensagem de erro para todos os campos em branco)";

      // finalizarAguardar();
      return false;
    } else {
      setInterval(sumirMensagem, 5000);
    }

    fetch("/usuarios/cadastrar", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
      },
      body: JSON.stringify({
        // crie um atributo que recebe o valor recuperado aqui
        // Agora vá para o arquivo routes/usuario.js
        nomeServer: nomeCompletoVar,
        emailServer: emailVar,
        numeroUsuarioServer: numeroUsuarioVar,
      }),
    })
      .then(function (resposta) {
        console.log("resposta: ", resposta);

        if (resposta.ok) {
          cardErro.style.display = "block";

          mensagem_erro.innerHTML =
            "Cadastro realizado com sucesso! Redirecionando para tela de Login...";

          setTimeout(() => {
            window.location = "login.html";
          }, "2000");

          limparFormulario();
          // finalizarAguardar();
        } else {
          throw "Houve um erro ao tentar realizar o cadastro!";
        }
      })
      .catch(function (resposta) {
        console.log(`#ERRO: ${resposta}`);
        // finalizarAguardar();
      });

    return false;
  }

  function sumirMensagem() {
    cardErro.style.display = "none";
  }
</script>